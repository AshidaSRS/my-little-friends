#! /usr/bin/env bash

# torstein.k.johansen@gmail.com

# Creates the file cache I use with the file-cache and ido-mode Emacs
# modules.

. $HOME/src/my-little-friends/bash/alexandria

dir_list="
$HOME/.emacs.d
$HOME/src/ece-scripts
$HOME/src/my-little-friends
$HOME/src/vosa
/opt/dropbox/doc/work
$HOME/src/p4/escenic/common/trunk
$HOME/src/p4/escenic/engine/trunk
$HOME/src/p4/escenic/model-core/trunk
$HOME/src/p4/escenic/plugins/analysis/trunk
$HOME/src/p4/escenic/plugins/community/trunk
$HOME/src/p4/escenic/plugins/dashboard/trunk
$HOME/src/p4/escenic/plugins/forum/trunk
$HOME/src/p4/escenic/plugins/semantic/trunk
$HOME/src/p4/escenic/plugins/viziwyg/trunk
$HOME/src/p4/escenic/studio/trunk
"
file_list="
/home/torstein/.bashrc
/home/torstein/.emacs
/home/torstein/.fluxbox/keys
/home/torstein/.fluxbox/init
/home/torstein/.fluxbox/startup
"

file=~/.emacs.d/file_cache.el

print "Generating new file cache $file"
echo "(" > $file

for el in $dir_list; do
    find $el -type f | \
	      egrep -vi "/test/|TAGS|\\.man|elpa|session\\.|\\.hg" | \
	      egrep -vi "\\.tmp|Catalina|\\.iml|\\.iws|\\.ipr|\#|\\.log" | \
	      egrep -vi "target|\\.jar|\\.html|\\.png|\\.jpg|\\.bmp|\\.xls" | \
	      egrep -vi "\\.git|\\.svn|\~|\\.class|\\.swp|\\.pdf|\\.gif|\\.cache" | \
	      while read f; do
	      file_name=$(basename "$f")
	      directory=$(dirname "$f")
	      echo "(\""${file_name}"\" \""${directory}"/\")" >> $file
    done
done

for el in $file_list; do
	  file_name=$(basename "$el")
	  directory=$(dirname "$el")
	  echo "(\""${file_name}"\" \""${directory}"/\")" >> $file
done

echo ")" >> $file

print "Done, $file is now ready"

# $HOME/src/p4/projects/poc/memento
# $HOME/src/p4/projects/poc/inpage-poc
